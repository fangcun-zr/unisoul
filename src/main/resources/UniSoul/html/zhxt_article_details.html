<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>文章详情 -  学途心绘坊</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.0.0/css/all.min.css">
    <link rel="stylesheet" href="../css/zhxt_article_details.css">
</head>
<body>
<!-- 背景装饰 -->
<div class="background-decoration">
    <div class="circle c1"></div>
    <div class="circle c2"></div>
    <div class="circle c3"></div>
    <div class="wave-container">
        <svg viewBox="0 0 1440 320" class="wave">
            <path fill="#4299e1" fill-opacity="0.2" d="M0,192L48,197.3C96,203,192,213,288,229.3C384,245,480,267,576,250.7C672,235,768,181,864,181.3C960,181,1056,235,1152,234.7C1248,235,1344,181,1392,154.7L1440,128L1440,320L1392,320C1344,320,1248,320,1152,320C1056,320,960,320,864,320C768,320,672,320,576,320C480,320,384,320,288,320C192,320,96,320,48,320L0,320Z"></path>
        </svg>
    </div>
</div>

<!-- 导航栏 -->
<nav class="navbar navbar-expand-lg navbar-glass">
    <!-- 导航栏内容保持不变 -->
</nav>

<!-- 主要内容 -->
<div class="container mt-4">
    <div class="content-container">
        <!-- 左侧文章内容 -->
        <div class="article-main animate__animated animate__fadeInLeft">
            <!-- 文章头部 -->
            <div class="article-header">
                <div class="article-category">
                    <i class="fas fa-folder"></i>
                    <span>心理健康</span>
                </div>
                <div class="article-meta">
                    <div class="meta-item">
                        <i class="fas fa-calendar"></i>
                        <span class="article-time">发布时间</span>
                    </div>
                    <div class="meta-item">
                        <i class="fas fa-eye"></i>
                        <span>阅读量</span>
                    </div>
                </div>
            </div>

            <!-- 文章标题 -->
            <h1 class="article-title"></h1>

            <!-- 作者信息 -->
            <div class="author-card">
                <div class="author-info">
                    <img src="../image/avatar.png" alt="作者头像" class="author-avatar">
                    <div class="author-detail">
                        <h4 class="author-name">作者名称</h4>
                        <p class="author-bio">作者简介</p>
                    </div>
                </div>
                <button class="btn btn-follow" id="btn-follow" data-username="username" data-status="unfollowed">
                    <i class="fas fa-plus"></i> 关注作者
                </button>
            </div>

            <!-- 文章摘要生成工具 -->
            <div class="summary-tools">
                <div class="input-group mb-3">
                    <span class="input-group-text">摘要比例</span>
                    <select class="form-select" id="summary-ratio">
                        <option value="1">10%</option>
                        <option value="2">20%</option>
                        <option value="3">30%</option>
                        <option value="4">40%</option>
                        <option value="5" selected>50%</option>
                        <option value="6">60%</option>
                        <option value="7">70%</option>
                        <option value="8">80%</option>
                        <option value="9">90%</option>
                    </select>
                    <button class="btn btn-primary" id="get-summary">
                        <i class="fas fa-compress-alt"></i> 生成摘要
                    </button>
                </div>
            </div>

            <!-- 文章内容 -->
            <div class="article-content"></div>

            <!-- 文章标签 -->
            <div class="article-tags">
                <i class="fas fa-tags"></i>
                <div class="tag-list">
                    <!-- 标签将通过JS动态加载 -->
                </div>
            </div>

            <!-- 文章操作 -->
            <div class="article-actions">
                <div class="action-left">
                    <button class="btn-action btn-like" title="点赞">
                        <i class="far fa-heart"></i>
                        <span class="like-count">0</span>
                    </button>
                    <button class="btn-action btn-favorite" title="收藏">
                        <i class="far fa-star"></i>
                        <span class="favorite-count">0</span>
                    </button>
                </div>
                <div class="action-right">
                    <button class="btn-action btn-share" title="复制链接分享">
                        <i class="fas fa-share-alt"></i>
                        <span>分享</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- 右侧边栏 -->
        <div class="article-sidebar animate__animated animate__fadeInRight">
            <!-- 目录导航 -->
            <div class="toc-card">
                <div class="card-header">
                    <h3><i class="fas fa-list"></i> 目录</h3>
                </div>
                <div class="toc-content">
                    <!-- 目录将通过JS动态生成 -->
                </div>
            </div>

            <!-- 相关文章 -->
            <div class="related-card">
                <div class="card-header">
                    <h3><i class="fas fa-link"></i> 相关文章</h3>
                </div>
                <div class="related-list">
                    <!-- 相关文章将通过JS动态加载 -->
                </div>
            </div>

            <!-- 推荐作者 -->
            <div class="recommend-card">
                <div class="card-header">
                    <h3><i class="fas fa-user-friends"></i> 推荐作者</h3>
                </div>
                <div class="recommend-list">
                    <!-- 推荐作者将通过JS动态加载 -->
                </div>
            </div>
        </div>
    </div>

    <!-- 评论区 -->
    <div class="comment-section animate__animated animate__fadeInUp">
        <div class="comment-header">
            <h3><i class="fas fa-comments"></i> 评论区</h3>
            <div class="comment-filter">
                <button class="btn-filter active" data-filter="latest">最新</button>
                <button class="btn-filter" data-filter="hot">最热</button>
            </div>
        </div>

        <!-- 评论编辑器 -->
        <div class="comment-editor">
            <div class="editor-header">
                <img src="../image/avatar.png" alt="用户头像" class="user-avatar">
                <span class="editor-tip">发表评论</span>
            </div>
            <form id="commentForm">
                <input type="hidden" id="article-id" value="1">
                <textarea id="commentContent" class="form-control" rows="3" placeholder="写下你的想法..."></textarea>
                <div class="invalid-feedback"></div>
                <div class="editor-footer">
                    <div class="editor-tools">
                        <button type="button" class="btn-tool" title="插入表情">
                            <i class="far fa-smile"></i>
                        </button>
                        <button type="button" class="btn-tool" title="插入图片">
                            <i class="far fa-image"></i>
                        </button>
                    </div>
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-paper-plane me-1"></i> 发布评论
                    </button>
                </div>
            </form>
        </div>

        <!-- 评论列表容器 -->
        <div class="comment-list">
            <!-- 评论将通过JavaScript动态加载 -->
            <div class="text-center py-4">
                <div class="spinner-border text-primary" role="status">
                    <span class="visually-hidden">加载中...</span>
                </div>
                <p class="mt-2">正在加载评论...</p>
            </div>
        </div>

        <!-- 评论分页 -->
        <div class="comment-pagination text-center my-4">
            <!-- 分页将通过JS动态生成 -->
        </div>

        <!-- 加载更多 -->
        <div class="load-more text-center my-4">
            <button class="btn btn-outline-primary" id="loadMore">
                <i class="fas fa-sync-alt me-1"></i> 加载更多
            </button>
        </div>
    </div>
</div>

<!-- 回复评论模态框 -->
<div class="modal fade" id="replyModal">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title"><i class="far fa-comment me-2"></i>回复评论</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="original-comment mb-3 p-3 bg-light rounded"></div>
                <form id="replyForm">
                    <input type="hidden" id="replyCommentId">
                    <div class="mb-3">
                        <label for="replyContent" class="form-label">回复内容</label>
                        <textarea class="form-control" id="replyContent" rows="3" required></textarea>
                        <div class="invalid-feedback"></div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">取消</button>
                <button type="button" class="btn btn-primary" id="submitReply">
                    <i class="fas fa-reply me-1"></i> 提交回复
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Toast notification container -->
<div class="position-fixed bottom-0 end-0 p-3" style="z-index: 11">
    <div id="commentToast" class="toast" role="alert" aria-live="assertive" aria-atomic="true">
        <div class="toast-header">
            <strong class="me-auto">消息通知</strong>
            <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>
        </div>
        <div class="toast-body">
            操作成功
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
<!-- 初始化文章ID -->
<script>
    // 确保在其他脚本加载前设置文章ID
    document.addEventListener('DOMContentLoaded', function() {
        // 从URL获取文章ID
        const urlParams = new URLSearchParams(window.location.search);
        const articleId = urlParams.get('id') || 1;
        console.log('从URL初始化文章ID:', articleId);

        // 设置到隐藏字段
        document.getElementById('article-id').value = articleId;
    });
</script>
<script src="../api/zhxt_articles.js"></script>
<script src="../js/zhxt_article_details.js"></script>

</body>
</html>